<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸­ç¾ç¤¾ä¼šè´¡çŒ®åº¦å¯¹æ¯”æ›²çº¿</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/chart.js@4.4.3/dist/chart.umd.js"></script>
    <style>
        .chart-container {
            position: relative;
            height: 400px;
            width: 100%;
        }
    </style>
</head>
<body class="bg-gray-100">
    <div class="p-6 max-w-6xl mx-auto">
        <h1 class="text-3xl font-bold text-center mb-2">ä¸­ç¾ç¤¾ä¼šè´¡çŒ®åº¦å¯¹æ¯”æ›²çº¿</h1>
        <p class="text-center text-gray-600 mb-6">åŸºäºæœ¬ç§‘å­¦å†åŠ³åŠ¨åŠ›çš„ç”Ÿå‘½å‘¨æœŸåˆ†æ</p>

        <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
            <div class="chart-container">
                <canvas id="contributionChart"></canvas>
            </div>
        </div>

        <div class="grid md:grid-cols-2 gap-6">
            <div class="bg-red-50 rounded-lg p-5 border-l-4 border-red-500">
                <h2 class="text-xl font-bold text-red-700 mb-3 flex items-center">
                    <span class="mr-2">ğŸ‡¨ğŸ‡³</span> ä¸­å›½æ›²çº¿ç‰¹å¾
                </h2>
                <div class="space-y-3" id="china-stages">
                    <!-- ä¸­å›½é˜¶æ®µä¿¡æ¯å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>

            <div class="bg-blue-50 rounded-lg p-5 border-l-4 border-blue-500">
                <h2 class="text-xl font-bold text-blue-700 mb-3 flex items-center">
                    <span class="mr-2">ğŸ‡ºğŸ‡¸</span> ç¾å›½æ›²çº¿ç‰¹å¾
                </h2>
                <div class="space-y-3" id="us-stages">
                    <!-- ç¾å›½é˜¶æ®µä¿¡æ¯å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
        </div>

        <div class="mt-6 bg-gray-50 rounded-lg p-5">
            <h3 class="text-lg font-bold mb-3">æ ¸å¿ƒå·®å¼‚æ€»ç»“</h3>
            <div class="grid md:grid-cols-2 gap-4 text-sm">
                <div>
                    <h4 class="font-semibold text-red-700 mb-2">ä¸­å›½ç‰¹ç‚¹:</h4>
                    <ul class="space-y-1 text-gray-700">
                        <li>â€¢ æ•™è‚²æœŸè´Ÿå€¼æ›´å¤§(å…¬ç«‹æ•™è‚²æ”¿åºœæŠ•å…¥é«˜)</li>
                        <li>â€¢ å£®å¹´æœŸæœ‰"å®¶åº­æ”¯æŒ"è´Ÿæ‹…(æ”¯æŒå­å¥³è´­æˆ¿ç­‰)</li>
                        <li>â€¢ å›½ä¼å‘˜å·¥å®é™…ç¨è´Ÿæ›´é‡(åˆ©æ¶¦ä¸Šç¼´)</li>
                        <li>â€¢ é€€ä¼‘æœŸç§ä¼å‘˜å·¥ç¤¾ä¼šè´Ÿæ‹…æ›´é‡</li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-semibold text-blue-700 mb-2">ç¾å›½ç‰¹ç‚¹:</h4>
                    <ul class="space-y-1 text-gray-700">
                        <li>â€¢ æ•™è‚²æœŸè´Ÿå€¼è¾ƒå°(å®¶åº­è‡ªä»˜å¤š,æ”¿åºœæŠ•å…¥å°‘)</li>
                        <li>â€¢ å£®å¹´æœŸå³°å€¼æ›´é«˜æ›´æŒä¹…(æ— å›½ä¼åˆ©æ¶¦ä¸Šç¼´)</li>
                        <li>â€¢ æ— ä»£é™…è´­æˆ¿æ”¯æŒè´Ÿæ‹…</li>
                        <li>â€¢ é€€ä¼‘æœŸ401kè‡ªç†,ç¤¾ä¼šè´Ÿæ‹…å°</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="mt-4 text-xs text-gray-500 text-center">
            æ³¨: æœ¬å›¾è¡¨ä¸ºç†è®ºæ¨¡å‹,ä»…ç”¨äºè¯´æ˜ç»“æ„æ€§å·®å¼‚,ä¸ä»£è¡¨ç²¾ç¡®æ•°å€¼
        </div>
    </div>

    <script>
        // ç”Ÿæˆä¸­å›½æ•°æ®
        function generateChinaData() {
            const data = [];
            for (let age = 0; age <= 78; age++) {
                let contribution = 0;

                if (age < 6) {
                    // å­¦é¾„å‰
                    contribution = -25 - age * 2;
                } else if (age < 22) {
                    // å—æ•™è‚²é˜¶æ®µ (å…¬ç«‹æ•™è‚²,æ”¿åºœæŠ•å…¥å¤§)
                    contribution = -35 - (age - 6) * 1.5;
                } else if (age < 25) {
                    // åˆšå·¥ä½œ,å¿«é€Ÿä¸Šå‡
                    contribution = -30 + (age - 22) * 25;
                } else if (age < 30) {
                    // å©šè‚²å¹´é¾„,å¯¹å­å¥³æ”¯æŒå¼€å§‹
                    contribution = 45 + (age - 25) * 3;
                } else if (age < 50) {
                    // å£®å¹´æœŸé«˜å³°,ä½†è¦æ”¯æŒå­å¥³ä¹°æˆ¿ç­‰
                    const basePeak = 60 + (age - 30) * 0.5;
                    const familySupport = age > 35 ? -8 : 0; // 35å²åå¼€å§‹æ”¯æŒå­å¥³
                    contribution = basePeak + familySupport;
                } else if (age < 60) {
                    // åæœŸ,ç»§ç»­æ”¯æŒå­å¥³
                    contribution = 70 - (age - 50) * 2 - 10;
                } else if (age < 65) {
                    // é€€ä¼‘å‰åè¿‡æ¸¡æœŸ
                    contribution = 40 - (age - 60) * 8;
                } else {
                    // é€€ä¼‘æœŸ (ç§ä¼é€€ä¼‘é‡‘ä½,ç¤¾ä¼šè´Ÿæ‹…é‡)
                    contribution = 0 - (age - 65) * 2.5;
                }

                data.push({ age, china: Math.round(contribution * 10) / 10 });
            }
            return data;
        }

        // ç”Ÿæˆç¾å›½æ•°æ®
        function generateUSData() {
            const data = [];
            for (let age = 0; age <= 79; age++) {
                let contribution = 0;

                if (age < 6) {
                    // å­¦é¾„å‰
                    contribution = -20 - age * 1.5;
                } else if (age < 22) {
                    // å—æ•™è‚²é˜¶æ®µ (ç§ç«‹æ¯”ä¾‹é«˜,å®¶åº­è´Ÿæ‹…å¤§,æ”¿åºœæŠ•å…¥ç›¸å¯¹å°)
                    contribution = -15 - (age - 6) * 0.8;
                } else if (age < 26) {
                    // åˆšå·¥ä½œ,ä½†å¯èƒ½æœ‰å­¦è´·
                    contribution = -10 + (age - 22) * 15;
                } else if (age < 35) {
                    // å¿«é€Ÿä¸Šå‡æœŸ
                    contribution = 50 + (age - 26) * 3;
                } else if (age < 55) {
                    // å£®å¹´æœŸé«˜å³° (æ— å›½ä¼åˆ©æ¶¦ä¸Šç¼´,ç¨è´Ÿç›¸å¯¹çº¯ç²¹)
                    contribution = 77 + (age - 35) * 0.15;
                } else if (age < 65) {
                    // åæœŸ
                    contribution = 80 - (age - 55) * 2;
                } else if (age < 70) {
                    // é€€ä¼‘åˆæœŸ (401kè‡ªç†,ç¤¾ä¼šè´Ÿæ‹…å°)
                    contribution = 60 - (age - 65) * 6;
                } else {
                    // è€å¹´æœŸ (åŒ»ç–—æ”¯å‡ºé«˜)
                    contribution = 30 - (age - 70) * 4;
                }

                data.push({ age, us: Math.round(contribution * 10) / 10 });
            }
            return data;
        }

        // åˆå¹¶æ•°æ®
        const chinaData = generateChinaData();
        const usData = generateUSData();
        
        // åˆ›å»ºå›¾è¡¨æ•°æ®
        const chartData = chinaData.map((item, index) => ({
            age: item.age,
            china: item.china,
            us: usData[index]?.us || 0
        }));

        // å‡†å¤‡å›¾è¡¨æ•°æ®
        const ages = chartData.map(item => item.age);
        const chinaValues = chartData.map(item => item.china);
        const usValues = chartData.map(item => item.us);

        // åˆ›å»ºå›¾è¡¨
        const ctx = document.getElementById('contributionChart').getContext('2d');
        const chart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: ages,
                datasets: [
                    {
                        label: 'ä¸­å›½',
                        data: chinaValues,
                        borderColor: '#ef4444',
                        backgroundColor: 'rgba(239, 68, 68, 0.1)',
                        borderWidth: 2.5,
                        fill: false,
                        tension: 0.4
                    },
                    {
                        label: 'ç¾å›½',
                        data: usValues,
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        borderWidth: 2.5,
                        fill: false,
                        tension: 0.4
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: {
                        title: {
                            display: true,
                            text: 'å¹´é¾„(å²)'
                        }
                    },
                    y: {
                        title: {
                            display: true,
                            text: 'ç¤¾ä¼šè´¡çŒ®åº¦'
                        },
                        min: -60,
                        max: 100
                    }
                },
                plugins: {
                    legend: {
                        position: 'top',
                    },
                    tooltip: {
                        callbacks: {
                            title: function(context) {
                                return `å¹´é¾„: ${context[0].label}å²`;
                            }
                        }
                    }
                }
            }
        });

        // ä¸­å›½é˜¶æ®µä¿¡æ¯
        const chinaStages = [
            { range: "0-22å²", desc: "å—æ•™è‚²æœŸï¼Œå…¬ç«‹æ•™è‚²ä¸»å¯¼ï¼Œæ”¿åºœæŠ•å…¥å¤§ï¼Œä¸ªäººè´Ÿæ‹…å°", value: "-35è‡³-55" },
            { range: "22-30å²", desc: "å¿«é€Ÿä¸Šå‡æœŸï¼Œè¿›å…¥åŠ³åŠ¨å¸‚åœº", value: "-30è‡³+60" },
            { range: "30-50å²", desc: "é«˜å³°æœŸï¼Œä½†éœ€æ”¯æŒå­å¥³(è´­æˆ¿ç­‰)ï¼Œå›½ä¼å‘˜å·¥ç¨è´Ÿæ›´é‡", value: "+50è‡³+70" },
            { range: "50-65å²", desc: "ç»§ç»­å·¥ä½œï¼ŒæŒç»­æ”¯æŒå­å¥³æ–°å®¶åº­", value: "+30è‡³+60" },
            { range: "65å²+", desc: "é€€ä¼‘æœŸï¼Œç§ä¼é€€ä¼‘é‡‘ä½ï¼Œç¤¾ä¼šè´Ÿæ‹…é‡", value: "0è‡³-35" }
        ];

        // ç¾å›½é˜¶æ®µä¿¡æ¯
        const usStages = [
            { range: "0-22å²", desc: "å—æ•™è‚²æœŸï¼Œç§ç«‹æ•™è‚²æ¯”ä¾‹é«˜ï¼Œå®¶åº­è‡ªä»˜å¤šï¼Œæ”¿åºœæŠ•å…¥ç›¸å¯¹å°", value: "-15è‡³-30" },
            { range: "22-35å²", desc: "å¿«é€Ÿä¸Šå‡æœŸï¼Œå¯èƒ½èƒŒè´Ÿå­¦è´·", value: "-10è‡³+77" },
            { range: "35-55å²", desc: "é«˜å³°æœŸï¼Œæ— å›½ä¼åˆ©æ¶¦ä¸Šç¼´åˆ¶åº¦", value: "+77è‡³+80" },
            { range: "55-70å²", desc: "åæœŸåŠé€€ä¼‘åˆæœŸï¼Œ401kè‡ªç†", value: "+20è‡³+60" },
            { range: "70å²+", desc: "è€å¹´æœŸï¼ŒåŒ»ç–—æ”¯å‡ºé«˜", value: "+30è‡³-10" }
        ];

        // åŠ¨æ€ç”Ÿæˆé˜¶æ®µä¿¡æ¯
        function generateStageInfo(containerId, stages) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            
            stages.forEach((stage, idx) => {
                const stageDiv = document.createElement('div');
                stageDiv.className = 'bg-white rounded p-3';
                stageDiv.innerHTML = `
                    <div class="font-semibold text-${containerId === 'china-stages' ? 'red' : 'blue'}-800">${stage.range}</div>
                    <div class="text-sm text-gray-700 mt-1">${stage.desc}</div>
                    <div class="text-xs text-${containerId === 'china-stages' ? 'red' : 'blue'}-600 mt-1">è´¡çŒ®åº¦èŒƒå›´: ${stage.value}</div>
                `;
                container.appendChild(stageDiv);
            });
        }

        // ç”Ÿæˆé˜¶æ®µä¿¡æ¯
        generateStageInfo('china-stages', chinaStages);
        generateStageInfo('us-stages', usStages);
    </script>
</body>
</html>